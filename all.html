<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Backlift Documentation</title>
    <link type="text/css" rel="stylesheet" href="http://fonts.googleapis.com/css?family=Droid+Sans&subset=latin">
    <link type="text/css" rel="stylesheet" href="/docs/css/reset.css">
    <link type="text/css" rel="stylesheet" href="/docs/css/docs.css">
    <link type="text/css" rel="stylesheet" href="/docs/css/print.css" media="print">
    <link type="text/css" rel="stylesheet" href="http://yandex.st/highlightjs/6.1/styles/default.min.css">
    
        <link type="text/css" rel="stylesheet" href="style.css">
    
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js"></script>
    <script type="text/javascript" src="http://yandex.st/highlightjs/6.1/highlight.min.js"></script>
    
    <script type="text/javascript" src="/docs/js/viewer.js"></script>
</head>
<body>
    <div id="page">
        <a name="top" />
        
            <header id="header">
                <h1><a href="/docs/">Backlift Documentation</a></h1>
            </header>
        
        <div id='content'><a name="backlift"></a><h1>Backlift</h1>
<a name="introduction"></a><h2>Introduction</h2>
<p>Backlift wants to make building and deploying websites easier, faster and more creative. 

</p>
<p>Backlift&#39;s server, templates and helper libraries support:

</p>
<ul>
<li><strong>Asynchronous updates:</strong> Build apps that respond immediately to user actions while data is sent to the server in the background. </li>
<li><strong>API discovery:</strong> Backlift will let you persist data without specifying the API up front. If you follow standard RESTful conventions, backlift will accept whatever data you throw at it.</li>
<li><strong>Familiar libraries:</strong> Backlift currently works with <a href="http://backbonejs.org">Backbone.js</a>, <a href="http://angularjs.org/">Angular.js</a> and <a href="http://knockoutjs.com/">Knockout.js</a>. We plan to integrate other javascript MVC libraries in the future.</li>
</ul>
<p>Backlift&#39;s goals are to facilitate:

</p>
<ul>
<li>rapid user experience prototyping,</li>
<li>learning to write front-end javascript code, and eventually,</li>
<li>deploying production websites used by millions.</li>
</ul>
<p>Please visit <a href="https://www.backlift.com">backlift.com</a> to access your backlift account.

</p>
<p>Bugs or feature requests for backlift can be submitted to the <a href="http://github.com/backlift/docs/issues">issues</a> page of this documentation&#39;s github project.

</p>
<p>Our roadmap is posted <a href="http://roadma.ps/28R">here</a>.

</p>
<p>The source to this documentation is available <a href="http://github.com/backlift/docs">on github</a>. We will happily accept pull requests to the docs.


</p>
<a name="getting-started-with-dropbox"></a><h2>Getting started with Dropbox</h2>
<p>Dropbox is now the suggested way to work with Backlift. You can login with Dropbox from the landing page at <a href="https://www.backlift.com">backlift.com</a>. Alternatively, if you already have an account, you can login and click on the &quot;create app&quot; page. From here you can link your account to Dropbox.

</p>
<p>Linking Dropbox will give Backlift access to the Apps/Backlift folder within your Dropbox account. No other Dropbox content will be accessible to Backlift. This means that you can safely link Backlift with Dropbox without worrying that private information in your Dropbox account will be shared.

</p>
<p>For an alternative to Dropbox, see the section on the <a href="commandline.html">command line utility</a>.</p>

<a name="backlift-basics"></a><h1>Backlift basics</h1>
<a name="creating-an-app"></a><h2>Creating an app</h2>
<p>You can create a new app with Dropbox using the <a href="https://www.backlift.com/dashboard/createapp">create new app</a> form. Your app&#39;s files will be placed in the <code>/Apps/Backlift</code> folder of your Dropbox folder. While you are connected to the internet, any changes you make will automatically be synchronized to your Backlift app&#39;s website via Dropbox. 

</p>
<p>To see your new app online, visit your app&#39;s website with a browser, such as Google Chrome. You can find a link to your app&#39;s website in the <a href="https://www.backlift.com/dashboard/apps">apps</a> section of your Backlift dashboard.

</p>
<a name="app-templates"></a><h3>App templates</h3>
<p>Backlift comes with a set of examples and starter templates. You can see the list of templates in the <a href="https://www.backlift.com/dashboard/createapp">create new app</a> area of the dashboard. You can also find a list of available templates on github at <a href="http://github.com/backlift/backlift-templates">http://github.com/backlift/backlift-templates</a>. 

</p>
<p>We&#39;d love to add your example or starter template to the backlift command line utility. Just submit a pull request to the backlift-templates project on github.

</p>
<a name="your-app39s-url"></a><h3>Your app&#39;s URL</h3>
<p>Backlift apps are assigned a unique and obscure URL based on the name you provide when creating the app. The format of the URL is:

</p>
<pre><code>&lt;appname&gt;-&lt;random_string&gt;.backliftapp.com</code></pre>
<p>This URL is not easy to guess, so you won&#39;t have unexpected visitors to your website while it&#39;s still in development. However it&#39;s publicly accessible, so you can share your work with others by sending them the URL. 

</p>
<p>In the future backlift will support custom URLs using your own domain.

</p>
<a name="project-layout"></a><h3>Project layout</h3>
<p>Files and folders within your app&#39;s folder can be layed out any way you like. Any files you add to your app folder will be accessible via the same path from your app&#39;s URL. For example if you create an &quot;about.html&quot; file in the /pages folder of your app, that file will be available by browsing to:

</p>
<pre><code>&lt;your-app&gt;.backliftapp.com/pages/about.html</code></pre>
<a name="backlift-variables-and-the-configyml-file"></a><h2>Backlift variables and the config.yml file</h2>
<p>If you look at the index.html file from the simple-site template, you will see template variables, such as the {{$&nbsp;scripts&nbsp;}} and {{$&nbsp;styles&nbsp;}} variables. These variables help you maintain your website by keeping track of your project files in a central place, the config.yml file. When your html page is rendered, Backlift will substitute those variables with appropriate data from the config.yml file. For example, the {{$&nbsp;scripts&nbsp;}} variable will be replaced by a list of <code>&lt;script&gt;</code> tags, one for each file listed in the config.yml scripts variable.

</p>
<!--
For a list of Backlift variables, please see the [variables reference](variables.html).

For more information about the configuration options available in the config.yml file, see the [configuration reference](configuration.html).
-->

<a name="the-static-folder"></a><h3>The Static folder</h3>
<p>Normally you may use Backlift variables in any html file that you add to your app. However, static files, like javascript, css and image files, shouldn&#39;t need to use the Backlift template variables. To speed up rendering of these pages, and to make better use of caching mechanisms, Backlift allows you to specify a static folder. Files within the static folder will not be rendered with the Backlift variables. The static folder can be set in your config.yml file. The default static folder is /public.

</p>
<a name="compilers-and-optimization"></a><h2>Compilers and optimization</h2>
<p>After your changes are uploaded via Dropbox or the CLI, Backlift will compile certain files and optionally optimize your javascript and css.

</p>
<a name="compilation-phase"></a><h3>Compilation phase</h3>
<p>During the compilation phase, files with known extensions are compiled into javascript or css. The following is a list of the known file extensions, the type of file generated, and the associated compiler:

</p>
<ul>
<li>.coffee --&gt; .js (<a href="http://coffeescript.org/">coffeescript</a> compiler)</li>
<li>.jst --&gt; .js (<a href="http://underscorejs.org/#template">underscore template</a> compiler)</li>
<li>.handlebars --&gt; .js (<a href="http://handlebarsjs.com/">handlebars</a> template compiler)</li>
<li>.less --&gt; .css (<a href="http://lesscss.org/">less</a> compiler)</li>
</ul>
<p>You can control which files are passed to the compilers by adding a <code>compile</code> directive to your project&#39;s config.yml file. The compile directive should include a list of files that will be compiled. The default, if no compile directive is specified, includes the following:

</p>
<pre><code class="no-highlight">compile:
- /**/*.jst
- /**/*.handlebars
- /**/bootstrap*.less
- /**/*.coffee
</code></pre>

<p>(Note that only the main bootstrap.less file will typically be compiled. This is because the bootstrap.less file imports several .less components. Attempting to pass those component .less files directly to the less compiler will result in an error.)

</p>
<p>Typically it will not be necessary to adjust the compile configuration. If no files of a particular kind exist, the compiler for that file type will not be invoked.

</p>
<a name="compilation-results-using-templates"></a><h3>Compilation results, Using templates</h3>
<p>The .js and .css files generated by the compilation phase will be added to the {{$&nbsp;scripts&nbsp;}} and {{$&nbsp;styles&nbsp;}} Backlift variables. 

</p>
<p>The scripts generated by the Underscore template compiler include code that adds the template to a global JST object. To use the template, simply call the function with the same name as the original template file, and pass it the template parameters to be rendered. For example, the file &quot;profile.jst&quot; will create a profile template function that can be used like so:

</p>
<pre><code>var rendered = JST.profile({username: &quot;Cole&quot;, hometown: &quot;San Francisco&quot;});
$(&quot;#profile-div&quot;).html(rendered);</code></pre>
<p>To use the scripts generated by the handlebars compiler, see the <a href="http://handlebarsjs.com/">handlebars documentation</a>. You will need to include the handlebars.js script in your config.yml scripts list. Here is an example of a &quot;profile.handlebars&quot; template in use:

</p>
<pre><code>var rendered = Handlebars.templates.profile({
    username: &quot;Cole&quot;,
    hometown: &quot;San Francisco&quot;
});
$(&quot;#profile-div&quot;).html(rendered);</code></pre>
<a name="optimization-phase"></a><h3>Optimization phase</h3>
<p>During the optimization phase, javascript and css files are concatenated and minified. Optimization can be enabled or disabled using the <code>optimize</code> setting within config.yml.

</p>
<pre><code>optimize: on</code></pre>
<p>By default optimization is disabled. This reduces the time required to build your webapp, and avoides the obscure code generated by minification. Optimization should not be used during development.

</p>
<p>Backlift uses the YUI compressor to minify and concatenate javascript and css files. The optimizer will generate two files, <code>\public\optimized-scripts.js</code> and <code>\public\optmized-styles.css</code>. The {{$&nbsp;scripts&nbsp;}} and {{$&nbsp;styles&nbsp;}} Backlift variables will include only these two files if the optimizer is enabled.

</p>
<a name="the-admin-site"></a><h2>The admin site</h2>
<p>Each app gets a unique admin page that can be used for debugging and, in the future, managing security features like validation and authorization. You can view your app&#39;s admin page by clicking on the small gear icon under your app in the <a href="https://www.backlift.com/dashboard/apps">apps</a> section of your Backlift dashboard.

</p>
<p>As you develop your app, the admin page will change to reflect your app&#39;s collections and request history. This makes it a valuable debugging tool.
</p>

<a name="data-persistence"></a><h1>Data persistence</h1>
<p>In Backlift any app can store data on the server and retreive it later. This allows apps to implement complex functionality, such as collecting data from users via forms and visualizing that data in meaningful ways, or cordinating moves in a multiplayer game. You don&#39;t need to understand databases or SQL to store and retrieve data, just a basic understanding of javascript and jQuery. If you know how to fetch data jusing jQuery&#39;s ajax() methods, you can use the Backlift persistence API.

</p>
<a name="collections-and-models"></a><h2>Collections and models</h2>
<p>Backlift uses just one data structure for persistence, the collection. A collection is just a group of things. Each thing in a collection is referred to as a model, and each model holds a set of related properties that describe the thing. A property has a name and a value. The models in a Backlift collection are not required to have the same properties.

</p>
<p>For example, if you were building a library app, you might have a books collection. Each model in the collection would represent a single book, and might have a name, author, status and optional waiting property. Here&#39;s what such a collection would look like in Javascript Object Notation (JSON):

</p>
<pre><code>{&quot;books&quot;: [
    {&quot;name&quot;: &quot;The Corrections&quot;,
     &quot;author&quot;: &quot;Jonathan Franzen&quot;,
     &quot;status&quot;: &quot;checked-out&quot;,
     &quot;waiting&quot;: &quot;Cole Krumbholz&quot;},

    {&quot;name&quot;: &quot;Freedom&quot;,
     &quot;author&quot;: &quot;Jonathan Franzen&quot;,
     &quot;status&quot;: &quot;available&quot;}
]}</code></pre>
<a name="the-persistence-api"></a><h2>The persistence API</h2>
<p>Data is stored and retrieved using the persistence API. It&#39;s not a formal API beacause any URL that matches the pattern below is acceptable:

</p>
<ul>
<li><p>GET /backlift/data/&lt;collection&gt;: will retrieve a list of the models in a collection.</p>
</li>
<li><p>POST /backlift/data/&lt;collection&gt;: will create a new model and add it to a collection.</p>
</li>
<li><p>GET /backlift/data/&lt;collection&gt;/&lt;item_id&gt;: will retrieve a specific model from a collection.</p>
</li>
<li><p>PUT /backlift/data/&lt;collection&gt;/&lt;item_id&gt;: will update a model in a collection.</p>
</li>
<li><p>DELETE /backlift/data/&lt;collection&gt;/&lt;item_id&gt;: will delete a model.</p>
</li>
</ul>
<p>The data for PUT and POST requests should be sent in the request body, and can either be a JSON object or a url-encoded set of key-value pairs. 

</p>
<p>Backlift stores the data as JSON documents, and does not need to know what properties a document will have in advance. In addition, collections do not need to be created before they are used. If a POST request is made for a collection the doesn&#39;t exist, Backlift will create it. If a GET request is made on a collection that doesn&#39;t exist, Backlift will return an empty set.

</p>
<p>Later when you want to deploy your app in a production environment, you can setup validation via the config.yml config file. See the section on <a href="validation.html">data validation</a> for documentation on how to &quot;lock down&quot; a collection.

</p>
<a name="persistence-with-backbonejs"></a><h2>Persistence with Backbone.js</h2>
<p>When using Backbone.js to communicate with the Backlift server, you just need to prefix your urls with &quot;/backlift/data/&quot;. Backbone&#39;s default sync mechanism uses the URL scheme listed above. In fact, Backlift was built to allow backbone.js projects to work &quot;out of the box&quot;. 

</p>
<p>The following example shows how to set the url attribute of your collections and then use backbone&#39;s standard save and fetch methods.

</p>
<pre><code>var MyBook = Backbone.Model.extend({});

var MyBooks = Backbone.Collection.extend({
    model: MyBook,
    url: &quot;/backlift/data/books&quot;
});

var books = new MyBooks();
books.fetch();   // will issue a GET /backlift/data/books

var book = new MyBook({
    title: &quot;The Corrections&quot;
});

books.add(book);
book.save();   // will issue a POST /backlift/data/books</code></pre>
<a name="special-object-attributes"></a><h2>Special object attributes</h2>
<p>Each time the backlift server persists a new object, a few attributes are applied automatically:

</p>
<ul>
<li><p><strong>&#39;id&#39;</strong>: If no id is set, the server will assign a unique uuid to each model and store it in the &#39;id&#39; attribute. If there is an id, backlift will ensure that it is unique. </p>
</li>
<li><p><strong>&#39;_owner&#39;</strong>: This attribute is automatically assigned to the currently logged-in user&#39;s id attribute, if there is a currently logged-in user. This value is read-only.</p>
</li>
<li><p><strong>&#39;_created&#39;</strong>: When a new object is created, this attribute is set with the current date and time in ISO standard format. This value is read-only.</p>
</li>
<li><p><strong>&#39;_modified&#39;</strong>: Each time an object is updated, this attribute is set with the current date and time in ISO standard format. This value is read-only.</p>
</li>
<li><p><strong>&#39;_id&#39;</strong>: Backlift mirrors the id attribute in an &#39;_id&#39; attribute. The &#39;_id&#39; attribute is used by backlift&#39;s mongodb database. In the future this attribute may be filtered out, so it&#39;s best not to rely on it.</p>
</li>
</ul>
<a name="a-note-about-dates"></a><h3>A note about dates</h3>
<p>Backlift returns date/time values using the ISO 8601 format in UTC. These values can be parsed by Javascript&#39;s native Date object in all modern browsers. Here is an example of how to parse a date returned by backlift:

</p>
<pre><code>// an example of ISO 8601 UTC time
var obj = {_created: &quot;2012-12-18T05:36:47.946Z&quot;}; 

var date = new Date(obj._created);

console.log(date.toString());   // Mon Dec 17 2012 21:36:47 GMT-0800 (PST)
console.log(date.toJSON()));    // 2012-12-18T05:36:47.946Z</code></pre>
<p>The choice to go with ISO 8601 was somewhat arbitrary. There are several date time formats, and no particular format is prescribed in the JSON specification. We chose this format partly because it&#39;s what Date.toJSON() generates.</p>

<a name="validation"></a><h1>Validation</h1>
<a name="backlift-collections-and-schemas"></a><h2>Backlift collections and schemas</h2>
<p>Collections are like tables in a database and are defined by a set of attributes, or fields. In backlift individual models in a collection don&#39;t need to contain all the attributes of their sibling models. However, if any of the models in a collection contain an attribute, it will be considered a part of that collection&#39;s schema.

</p>
<p>By default there are no validation rules on any models in backlift. Anything can be stored in a collection, and new collections can be created on the fly. This is useful during development when the data model of an application is changing regularly. Later, when the application is ready for production, schema validation rules may be applied to &quot;lock down&quot; the kinds of data that backlift accepts.

</p>
<a name="defining-schemas"></a><h2>Defining schemas</h2>
<p>Currently backlift validation rules must be created using the config.yml configuration file. Here is an example section of the config.yml file that sets up a validation rule:

</p>
<pre><code>collections:
  tweets:
    message: {type: &#39;string&#39;, max: 140, required: yes}
    (other rules...)
  (other collections...)</code></pre>
<p>Each sub group under &#39;collections&#39; defines a new collection. When an AJAX request is sent to a /backlift/data/collection URL, backlift searches for the collection in this list. When found, the data attributes are matched against the rule names in order to select validation tests. If the data passes the tests for all attributes, the operation is permitted. 

</p>
<p>For a discussion of the permissions attributes used during authorization, see the <a href="authorization.html">authorization</a> section.

</p>
<p>The syntax for defining a new rule is:

</p>
<pre><code>&lt;field name&gt;: {[type: &#39;&lt;rule type&gt;&#39;,] &lt;parameter name&gt;: &lt;value&gt; [...]}</code></pre>
<p>If the rule &#39;type&#39; is omitted, it will be assumed to be a &#39;string&#39;.

</p>
<a name="validation-errors"></a><h2>Validation errors</h2>
<p>If one or more validation tests fail, backlift will return a 400 response along with a JSON object containing error data. The error data structure will look like this:

</p>
<pre><code>{&quot;form_errors&quot;: {
    &quot;message&quot;: [&quot;exceeds 140 character limit&quot;],
    &quot;otherfield&quot;: [&quot;required&quot;],
    &quot;&quot;: [&quot;other problems&quot;],
}}</code></pre>
<p>Each attribute of the &#39;form_errors&#39; hash is a field name, and the value is a list of error messages. The empty string attribute indicates form-wide errors.

</p>
<a name="validation-rule-reference"></a><h2>Validation rule reference</h2>
<p>The following is a list of validation rule types, and their type specific parameters.

</p>
<ul>
<li><p>&#39;<strong>string</strong>&#39; (min, max):
A string with an optional minimum and maximum length. This is the default validation type for all rules.</p>
</li>
<li><p>&#39;<strong>regex</strong>&#39; (regex):
A string that must match a regular expression. </p>
</li>
<li><p>&#39;<strong>identifier</strong>&#39;:
A strictly alpha-numeric string at least 2 characters long and no more than 30 characters long. (It must match the regular expression &#39;^[a-zA-Z0-9]{2,30}$&#39;) In addition identifiers are forced to lower-case when validated. Identifiers are used primarily for things like usernames and app IDs.</p>
</li>
<li><p>&#39;<strong>password</strong>&#39;: 
A string at least 8 characters long and no longer than 30 characters.</p>
</li>
<li><p>&#39;<strong>email</strong>&#39;:
Must be a valid email address.</p>
</li>
<li><p>&#39;<strong>list</strong>&#39;:
Must be a strig of the form &#39;[&quot;item&quot;, &quot;item&quot;, ...]&#39;. Allows string representations of lists to be stored and retreived without requiring json deserialization.</p>
</li>
<li><p>&#39;<strong>auto:uuid</strong>&#39;:
A string that matches the regex pattern &#39;^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$&#39;. A random uuid matching this pattern will be substituted for this attribute&#39;s value when the object is initially created.</p>
</li>
<li><p>&#39;<strong>auto:unique_uuid</strong>&#39;:
A string that matches the regex pattern &#39;^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$&#39;. A random uuid will be substituted for this attribute&#39;s value when the object is initially created. This value will be unique amongst values for this attribute on this collection.</p>
</li>
<li><p>&#39;<strong>auto:random_16_a0</strong>&#39;:
see below</p>
</li>
<li><p>&#39;<strong>auto:random_16_aA0</strong>&#39;:
see below</p>
</li>
<li><p>&#39;<strong>auto:unique_16_a0</strong>&#39;:
see below</p>
</li>
<li><p>&#39;<strong>auto:unique_16_aA0</strong>&#39;:
A string that matches the regex pattern &#39;^[a-zA-Z0-9]{16}$&#39; or &#39;^[a-z0-9]{16}$&#39;. A random string containing 16 alphanumeric characters (just lowercase, or upper and lowercase), will be substituted for this attribute&#39;s value when the object is initially created. If unique is specified the value will be unique amongst values for this attribute on this collection.</p>
</li>
</ul>
<p>This list is incomplete at this time. We will update this list as new validation rules are created.

</p>
<p>We realize that it is impossible to perform all server side data validation using a predetermined finite set of validation rules. Our goal is not to cover all possibilities. We are currently working to define a reasonable set that covers as much territory as possible. We are also evaluating alternatives for how to handle more custom validation needs.

</p>
<a name="common-validation-rule-parameters"></a><h2>Common validation rule parameters</h2>
<p>All validation rules accept the generic parameters &#39;default&#39;, &#39;required&#39; and &#39;readonly&#39;. 

</p>
<ul>
<li><p>The &#39;default&#39; parameter sets the value if no value is specified for an attribute.</p>
</li>
<li><p>The &#39;required&#39; parameter will ensure that a value is supplied for an attribute if set. (The value cannot be the empty string, nor can the attribute be absent entirely.)</p>
</li>
<li><p>The &#39;readonly&#39; parameter will cause the server to quietly reject any changes made to that attribute if set.</p>
</li>
</ul>
<p>A common pattern is to set a value for the &#39;default&#39; parameter, and set &#39;readonly&#39; to &#39;yes&#39;. This has the same effect of setting a fixed value for an attribute. All new objects created with these parameters will have the default value set for this attribute, which cannot be changed. This technique is effective for setting permissions on objects. See the <a href="authorization.html">authorization</a> section for further discussion.

</p>

<a name="authorization"></a><h1>Authorization</h1>
<p>The authorization plugin provides an API for registering and establishing sessions for users, storing private and public user data, and setting permissions on data objects.

</p>
<p>All passwords are salted and hashed before being stored using <a href="http://bcrypt.sourceforge.net/">bcrypt</a>. Currently all requests to backlift apps are encrypted with ssl using backlift&#39;s certificates. (All backlift app urls use the https:// protocol) User session cookies are encrypted and managed by the backlift app server via this API. 

</p>
<a name="user-data"></a><h2>User data</h2>
<p>Users are stored in a special collection within each app that can only be accessed through the auth API. A user model has the following schema (see <a href="validation.html#validation-rule-reference">validation section</a> for type reference).

</p>
<p>The user model:

</p>
<pre><code>&#39;id&#39;:           {&#39;type&#39;: &#39;auto:unique_16_aA0&#39;, &#39;readonly&#39;: True}
&#39;username&#39;:     {&#39;type&#39;: &#39;identifier&#39;, &#39;unique&#39;: True}
&#39;email&#39;:        {&#39;type&#39;: &#39;email&#39;, &#39;unique&#39;: True}
&#39;groups&#39;:       {&#39;type&#39;: &#39;list&#39;}
&#39;profile&#39;:      &lt;a profile model&gt;</code></pre>
<p>The user collection cannot be fetched. Only the single user model for the currently signed in user is accessible. Custom properties may be added to the user model which will remain private to the current user. For this reason, the user model is a good place to keep track of user preferences.

</p>
<p>The user model contains a reference to a profile model. The profiles collection is separate and can be accessed like any other collection. (See the data persistence section in <a href="basics.html#data-persistence">basics</a>) By default the name of the profile collection is &#39;profiles&#39;. It&#39;s default permissions for each profile object match the system wide default permissions. (see permissions <a href="#permissions-and-access-control">below</a>) Therefore profile models are publicly readonly by default, and fetching the profiles collection will yeild a list of user profiles. Custom properties may be added to a profile object, and they will be publicly accessible by default. For this reason, the profile object is a good place to store per-user public data.

</p>
<p>The profile model:

</p>
<pre><code>&#39;id&#39;:           {&#39;type&#39;: &#39;auto:unique_16_aA0&#39;, &#39;readonly&#39;: True}
&#39;username&#39;:     {&#39;type&#39;: &#39;identifier&#39;, &#39;readonly&#39;: True}</code></pre>
<p>Both the user and profile models include the special object properties specified <a href="basics.html#special-object-attributes">here</a>.

</p>
<p>To get or set data for the current user, use the current user API:

</p>
<pre><code>GET         /backlift/auth/currentuser 
POST or PUT /backlift/auth/currentuser { &lt;user model&gt; }</code></pre>
<p>If you are setting the user model, the data should be sent in the request body, and can either be a JSON object or a url-encoded set of key-value pairs. Not all the data fields must be set, only the included fields will be altered. Note that if you are setting the profile field, you must use JSON, not url-encoded data.

</p>
<a name="creating-users-and-signing-in"></a><h2>Creating users and signing in</h2>
<p>Backlift exposes the following API to facilitate user creation and management. The data should be sent in the request body, and can either be a JSON object or a url-encoded set of key-value pairs. 

</p>
<ul>
<li><p><strong>Creating users:</strong> (POST /backlift/auth/register)</p>
<p>You can create new users by sending a POST request to your app&#39;s /backlift/auth/register URL. The data you send should contain a &#39;username&#39; attribute, an &#39;email&#39; attribute, and a &#39;password&#39; attribute or &#39;password1&#39; and &#39;password2&#39; attributes. </p>
<pre><code>POST /backlift/auth/register {&quot;username&quot;: &quot;...&quot;, &quot;email&quot;: &quot;...&quot;, &quot;password&quot;: &quot;...&quot;}</code></pre>
<p>There are several alternative API endpoints that permit creating users with just an email address, or requiring an email and username:</p>
<pre><code>POST /backlift/auth/registernoemail {&quot;username&quot;: &quot;...&quot;, &quot;password&quot;: &quot;...&quot;}
POST /backlift/auth/registeremailonly {&quot;email&quot;: &quot;...&quot;, &quot;password&quot;: &quot;...&quot;}</code></pre>
<p>The response will contain a json object with the new user&#39;s data. </p>
</li>
<li><p><strong>Logging in:</strong> (POST /backlift/auth/login)</p>
<p>To log in a user, POST to the login url with a pair of &#39;username&#39; and &#39;password&#39; attributes. They will be compared against the salted and hashed password store and if they match, the user will be logged in.</p>
<p>When a user is logged in, two cookies will be set on the client, a session ID and a &#39;user&#39; cookie that contains the user id.</p>
</li>
<li><p><strong>Logging out:</strong> (POST or GET /backlift/auth/logout)</p>
<p>To log out a user, POST or GET to the logout url.</p>
<p>If you send a GET request, you can include a &#39;_next&#39; url parameter with a redirect url where the user will be sent after being logged out. For example the following link will log out a user and return them to the &#39;dashboard&#39; page:</p>
<pre><code>&lt;a href=&quot;/backlift/auth/logout?_next=/dashboard&quot;&gt; Log out &lt;/a&gt;</code></pre>
<p>By default the user will be redirected to &#39;/&#39; if logged out via a GET request.</p>
</li>
</ul>
<a name="permissions-and-access-control"></a><h2>Permissions and access control</h2>
<p>Backlift&#39;s authorization module allows you to control access to persisted objects. In backlift you authorize access to data, and build behaviors around that. A user profile object may be marked as readonly, which means that the server will reject attempts to update the profile object unless the currently logged-in user is the owner of that profile object.

</p>
<p>Backlift uses the following attributes on objects in order to control access:

</p>
<ul>
<li><p><strong>_owner</strong>: Whenever a user is logged-in, any objects created will have the _owner attribute set to the current user&#39;s id. This attribute is read-only and managed by the server.</p>
</li>
<li><p><strong>_groups</strong>: A list of groups to which the object belongs.</p>
</li>
<li><p><strong>_public_permissions</strong>, <strong>_group_permissions</strong>, <strong>_owner_permissions</strong>: Govern what actions are authorized on this object. It is a string containing any of the following characters. If one of the characters below is included in the string, it will grant the associated permission:</p>
<ul>
<li><strong>&#39;r&#39;</strong>: read   </li>
<li><strong>&#39;w&#39;</strong>: write   </li>
<li><strong>&#39;c&#39;</strong>: create  </li>
<li><strong>&#39;d&#39;</strong>: delete</li>
</ul>
</li>
</ul>
<p>For example, the following object is only accessible to the owner:

</p>
<pre><code>{ &quot;_owner&quot;: &quot;...&quot;, 
  &quot;_id&quot;: &quot;...&quot;, 
  &quot;_owner_permissions&quot;: &quot;rwcd&quot;,
  &quot;_group_permissions&quot;: &quot;&quot;,
  &quot;_public_permissions&quot;: &quot;&quot;}</code></pre>
<p>These are the default permissions that an object will be assigned, if the respective permissions attributes are missing on an object:

</p>
<ul>
<li>owner: read, write, create, delete</li>
<li>group: read, write</li>
<li>public: read</li>
</ul>
<a name="using-validation-rules-to-set-permissions"></a><h2>Using validation rules to set permissions</h2>
<p>Authorization depends on validation to ensure that the model attributes responsible for controlling user access are correctly configured and not altered by malicious clients. Currently these rules are set using the config.yml file. Here are a few examples of how to correctly set permissions on your models using the &#39;collections&#39; hash in the config.yml file:

</p>
<ul>
<li><p>Making the models of a collection readonly for the public:</p>
<pre><code>collections:
  tweets:
    message: {type: &#39;string&#39;, max: 140, required: yes}
    _public_permissions: {default: &#39;r&#39;, readonly: yes}</code></pre>
<p>In this example, tweets can be created and modified by users, due to default owner permissions. In this case we&#39;ve explicitly specified that the public can only read tweets, not change them. Tweets currently only contain the message field, but could contain other attributes, such as the geo-location where the tweet was created.</p>
</li>
<li><p>Making a private user profile:</p>
<pre><code>collections:
  profiles:
    _public_permissions: {default: &#39;&#39;, readonly: yes}</code></pre>
<p>This object cannot be read by the public. However the owner and members of this object&#39;s group will have access based on the default permissions.</p>
</li>
</ul>

<a name="backlift-api"></a><h1>Backlift API</h1>
<p>This is a reference for the Backlift API. Each API entry will have a definition, for example:

</p>
<pre><code>GET /backlift/auth/currentuser</code></pre>
<p>This specifies that a GET request can be sent to the /backlift/auth/currentuser URL. 

</p>
<p>All requests should use the app&#39;s domain as the host name. For example, the app <code>myapp-1ja0s</code> should send the above request to:

</p>
<pre><code class="no-highlight">https://myapp-1ja0s.backliftapp.com/backlift/auth/currentuser</code></pre>

<p>In practice, requests using jQuery $.ajax functions can leave off the domain name, and just send requests to /backlift/auth/currentuser like so:

</p>
<pre><code class="javascript">$.ajax({
    type: "GET",
    url: "/backlift/auth/currentuser",
    success: function(result) { 
        console.log(result); 
    }
});  
</code></pre>  

<p>All requests must be sent via https. Some requests require a logged in user or are effected by the current user session. The user session is managed using the auth login and logout APIs.

</p>
<p>For PUT or POST requests, parameters must be sent in the body of the request and can either be a JSON object, or a list of URL encoded parameters. All responses will be JSON.

</p>
<a name="data-persistence"></a><h2>Data Persistence</h2>
<p>List of data persistence API entries:

</p>
<ul>
<li><a href="api.html#retrieve-all-models-in-a-collection">Retrieve all models in a collection</a></li>
<li><a href="api.html#create-a-new-model">Create a new model</a></li>
<li><a href="api.html#retrieve-a-model-from-a-collection">Retrieve a model from a collection</a></li>
<li><a href="api.html#update-a-model">Update a model</a></li>
<li><a href="api.html#delete-a-model">Delete a model</a></li>
</ul>
<p></p>

<a name="retrieve-all-models-in-a-collection"></a><h3>Retrieve all models in a collection</h3>
<pre><code>GET /backlift/data/&lt;collection&gt;</code></pre>
<p>Returns a list of models in a collection. See the section on <a href="persistence.html">persistence</a> for more detail.

</p>
<p>Example usage:

</p>
<pre><code>$.ajax({
    type: &quot;GET&quot;,
    url: &quot;/backlift/data/todos&quot;,
    success: function(result) { 
        console.log(result); 
    }
});

// result: 
// [{
//    &quot;id&quot;:&quot;8c064fd0-616f-4e18-91e5-959b5475516f&quot;,
//    &quot;title&quot;:&quot;Do something&quot;,
//    &quot;order&quot;:1
//    ...
// },{
//    &quot;id&quot;:&quot;4928bcd1-56f7-40e4-ba78-212bae096b5c&quot;,
//    &quot;title&quot;:&quot;Something else&quot;,
//    &quot;order&quot;:2
//    ...
// }]</code></pre>
<a name="create-a-new-model"></a><h3>Create a new model</h3>
<pre><code>POST /backlift/data/&lt;collection&gt;</code></pre>
<p>Creates a new model for a collection. See the section on <a href="persistence.html">persistence</a> for more detail.

</p>
<p>Parameters:

</p>
<ul>
<li><strong>id</strong>: the id of the new object. If no id is supplied, the object will be assigned a random id. </li>
<li>... any additional parameters passed will become properties of the new model</li>
</ul>
<p>Returns: A copy of the new model that will include a new id property if one has been assigned.

</p>
<p>Example:

</p>
<pre><code>$.ajax({
    type: &quot;POST&quot;,
    url: &quot;/backlift/data/todos&quot;, 
    data: {
        title: &quot;Write Code&quot;,
        order: 3
    },
    success: function(result) { 
        console.log(result);
    } 
});

// result: 
// {
//    &quot;id&quot;:&quot;4928bcd1-56f7-40e4-ba78-212bae096b5c&quot;,
//    &quot;title&quot;:&quot;Write Code&quot;,
//    &quot;order&quot;:&quot;3&quot;,
//    ...
// }</code></pre>
<p>Errors:

</p>
<ul>
<li><p><strong>400 Bad Request</strong>: If the data submitted doesn&#39;t pass one of the validation tests, the response will be a 400 error. The result will be a JSON object with a &#39;form_errors&#39; property that contains a dictionary where the keys are names of the property for which a validation error was raised, and the values are lists of the validation errors for each property. For example:</p>
<pre><code>{&quot;form_errors&quot;:
    &quot;title&quot;: [&quot;must be 25 characters or less&quot;]
} </code></pre>
</li>
<li><p><strong>403 Not Authorized</strong>: This error occurs if the currently signed-in user doesn&#39;t have permission to perform this operation. This can occur if the model has an id that matches an existing model in the collection owned by another user. It can also occur if the collection&#39;s schema has an _owner_permissions attribute with a default that lacks create permissions. See <a href="authorization.html#permissions-and-access-control">permissions and access control</a> or more information.</p>
</li>
</ul>
<a name="retrieve-a-model-from-a-collection"></a><h3>Retrieve a model from a collection</h3>
<pre><code>GET /backlift/data/&lt;collection&gt;/&lt;model_id&gt;</code></pre>
<p>Returns a models. See the section on <a href="persistence.html">persistence</a> for more detail.

</p>
<p>Example usage:

</p>
<pre><code>$.ajax({
    type: &quot;GET&quot;,
    url: &quot;/backlift/data/todos/8c064fd0-616f-4e18-91e5-959b5475516f&quot;,
    success: function(result) { 
        console.log(result); 
    }
});

// result: 
// {
//    &quot;id&quot;:&quot;8c064fd0-616f-4e18-91e5-959b5475516f&quot;,
//    &quot;title&quot;:&quot;Do something&quot;,
//    &quot;order&quot;:1
//    ...
// }</code></pre>
<a name="update-a-model"></a><h3>Update a model</h3>
<pre><code>PUT /backlift/data/&lt;collection&gt;/&lt;model_id&gt;</code></pre>
<p>Updates a model. See the section on <a href="persistence.html">persistence</a> for more detail.

</p>
<p>Parameters:

</p>
<ul>
<li><strong>id</strong>: the id of the new object. If no id is supplied, the object will be assigned a random id. </li>
<li>... any additional parameters passed will become properties of the new model</li>
</ul>
<p>Returns: The updated model.

</p>
<p>Example:

</p>
<pre><code>$.ajax({
    type: &quot;PUT&quot;,
    url: &quot;/backlift/data/todos/4928bcd1-56f7-40e4-ba78-212bae096b5c&quot;, 
    data: {
        title: &quot;Write MORE Code&quot;,
        order: 1
    },
    success: function(result) { 
        console.log(result);
    } 
});

// result: 
// {
//    &quot;id&quot;:&quot;4928bcd1-56f7-40e4-ba78-212bae096b5c&quot;,
//    &quot;title&quot;:&quot;Write MORE Code&quot;,
//    &quot;order&quot;:&quot;1&quot;,
//    ...
// }</code></pre>
<p>Errors:

</p>
<ul>
<li><p><strong>400 Bad Request</strong>: If the data submitted doesn&#39;t pass one of the validation tests, the response will be a 400 error. The result will be a JSON object with a &#39;form_errors&#39; property that contains a dictionary where the keys are names of the property for which a validation error was raised, and the values are lists of the validation errors for each property. For example:</p>
<pre><code>{&quot;form_errors&quot;:
    &quot;title&quot;: [&quot;must be 25 characters or less&quot;]
} </code></pre>
</li>
<li><p><strong>403 Not Authorized</strong>: This error occurs if the currently signed-in user doesn&#39;t have permission to perform this operation. This can occur if the model to be updated is owned by another user, and the _public_permissions property excludes write permission. See <a href="authorization.html#permissions-and-access-control">permissions and access control</a> or more information.</p>
</li>
</ul>
<a name="delete-a-model"></a><h3>Delete a model</h3>
<pre><code>DELETE /backlift/data/&lt;collection&gt;/&lt;model_id&gt;</code></pre>
<p>Removes a model from it&#39;s collection. See the section on <a href="persistence.html">persistence</a> for more detail.

</p>
<p>Example:

</p>
<pre><code>$.ajax({
    type: &quot;DELETE&quot;,
    url: &quot;/backlift/data/todos/4928bcd1-56f7-40e4-ba78-212bae096b5c&quot;, 
    success: function(result) { 
        console.log(&quot;Deleted!&quot;);
    } 
});</code></pre>
<p>Errors:

</p>
<ul>
<li><strong>403 Not Authorized</strong>: This error occurs if the currently signed-in user doesn&#39;t have permission to perform this operation. This can occur if the model to be updated is owned by another user, and the _public_permissions property excludes delete permission. See <a href="authorization.html#permissions-and-access-control">permissions and access control</a> or more information.</li>
</ul>
<a name="authorization-and-users"></a><h2>Authorization and Users</h2>
<a name="register"></a><h3>Register</h3>
<pre><code>POST /backlift/auth/register  
POST /backlift/auth/registernoemail
POST /backlift/auth/registeremailonly</code></pre>
<p>Creates a user. See the section on <a href="authorization.html">authorization</a> for more detail.

</p>
<p>Parameters: (see <a href="validation.html#validation-rule-reference">validation reference</a>)

</p>
<pre><code>// regsiter and registernoemail
username: {type: &#39;identifier&#39;, required: yes, unique: yes}     
// register and registeremailonly
email: {type: &#39;email&#39;, required: yes, unique: yes}             
password: {type: &#39;password&#39;, required_if_empty: &#39;password1&#39;}
password1: {type: &#39;password&#39;, required_if_empty: &#39;password&#39;}
password2: {type: &#39;password&#39;, must_equal: &#39;password1&#39;}</code></pre>
<p>Returns: The created user model

</p>
<p>Example using AJAX:

</p>
<pre><code>$.ajax({
    type: &quot;POST&quot;,
    url: &quot;/backlift/auth/register&quot;, 
    data: {
        username: &quot;username&quot;,
        email: &quot;user@example.com&quot;,
        password1: &quot;password&quot;,
        password2: &quot;password&quot;
    },
    success: function(result) { 
        console.log(result);
    } 
});

// result: 
// {
//    &quot;id&quot;:&quot;JPwLMxPHmJDkGpwk&quot;
//    &quot;email&quot;: &quot;user@example.com&quot;,
//    &quot;username&quot;: &quot;username&quot;,
//    &quot;groups&quot;: [&quot;JPwLMxPHmJDkGpwk&quot;],
//    &quot;_modified&quot;: &quot;2012-12-17T07:18:23.823617Z&quot;,
//    &quot;_created&quot;: &quot;2012-12-17T07:18:23.823603Z&quot;,
//    &quot;profile&quot;: { 
//        &quot;username&quot;: &quot;username&quot;,
//        &quot;_created&quot;: &quot;2012-12-17T07:18:24.574915Z&quot;,
//        &quot;_modified&quot;:&quot;2012-12-17T07:18:24.574940Z&quot;,
//        &quot;_owner&quot;: &quot;JPwLMxPHmJDkGpwk&quot;
//    }
// }</code></pre>
<p>Example using a form:

</p>
<pre><code>&lt;form method=&quot;POST&quot; action=&quot;/backlift/auth/registernoemail&quot;&gt;
    Username: &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;
    Password: &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;_next&quot; value=&quot;/home&quot;&gt;
    &lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;</code></pre>
<a name="login"></a><h3>Login</h3>
<pre><code>POST /backlift/auth/login</code></pre>
<p>Signs in a user. See the section on <a href="authorization.html">authorization</a> for more detail.

</p>
<p>Parameters: (see <a href="validation.html#validation-rule-reference">validation reference</a>)

</p>
<pre><code class="javascript">username: {type: 'identifier', required_if_empty: 'email'}
email: {type: 'email', required_if_empty: 'username'}
password: {type: 'password', required: yes}
</code></pre>

<p>Example using AJAX:

</p>
<pre><code>$.ajax({
    type: &quot;POST&quot;,
    url: &quot;/backlift/auth/login&quot;, 
    data: {
        username: &quot;username&quot;,
        password: &quot;password&quot;
    },
    success: function(result) { 
        console.log(result);
    } 
});

// result: (same as register)
// {
//    &quot;id&quot;:&quot;JPwLMxPHmJDkGpwk&quot;
//    &quot;email&quot;: &quot;user@example.com&quot;,
//    &quot;profile&quot;: { 
//        &quot;username&quot;: &quot;username&quot;,
//        &quot;_owner&quot;: &quot;JPwLMxPHmJDkGpwk&quot;,
//        ...
//    },
//    ...
// }</code></pre>
<p>Example using a form:

</p>
<pre><code>&lt;form method=&quot;POST&quot; action=&quot;/backlift/auth/login&quot;&gt;
    Username: &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;
    Password: &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;_next&quot; value=&quot;/home&quot;&gt;
    &lt;input type=&quot;submit&quot;&gt;
&lt;/form&gt;</code></pre>

<a name="the-backlift-command-line-utility"></a><h1>The Backlift Command Line Utility</h1>
<p>The Backlift Command Line Interface (CLI) is an alternative for developers that are comfortable working in the terminal. Currently the CLI is the fastest way to synchronize your application changes with Backlift. The CLI requires Python 2.6.1 or later (all Macintintosh computers with OS X 10.6 or later come with this installed by default).

</p>
<p>To install the CLI, open up your terminal and type:

</p>
<pre><code>sudo easy_install backlift</code></pre>
<p>Alternatively, you can use pip to install the Backlift CLI into a virtual environment.

</p>
<p>Once you have backlift installed, create an account at <a href="https://backlift.com">backlift.com</a> by clicking on the &#39;Sign-in&#39; button in the upper right corner. You will need a registration key. In order to obtain one please click the &#39;Get Early Access&#39; link and supply your email address. We will send you a key as soon as possible.

</p>
<p>Once you have your api-key, setup backlift with the command:

</p>
<pre><code>backlift setup &lt;api-key&gt;</code></pre>
<p>Now you&#39;re ready to create new apps and upload them to backlift.

</p>
<p>From time to time you should make sure that you have the most recent version of the Backlift CLI. You can check that by typing <code>backlift --version</code>. It should match the &#39;Backlift CLI current version&#39; listed on your account dashboard. You can update your Backlift CLI by entering the command 

</p>
<pre><code>sudo easy_install --update backlift.</code></pre>
<a name="create-and-upload-a-new-app"></a><h3>Create and Upload a new app</h3>
<p>Create a new app with the command:

</p>
<pre><code>backlift create newapp</code></pre>
<p>This will create a new folder in the current directory called &#39;newapp&#39; and begin downloading the backlift default project template. Once the project template has finished downloading, check it out by opening the &#39;newapp&#39; folder with a text editor.

</p>
<p>To see this app running on a public web server, first change directories into the &#39;newapp&#39; folder and type &#39;backlift push&#39;.

</p>
<pre><code>cd newapp
backlift push</code></pre>
<p>This will upload the content of the &#39;newapp&#39; folder to Backlift. Alternatively you can use the command:
    <code>backlift watch</code>

</p>
<p>The watch command will first upload the &#39;newapp&#39; folder and then wait for changes to the project. Any time you edit and save a file in the &#39;newapp&#39; folder while the watch command is running, your changes will automatically by synced to Backlift.


</p>
<a name="view-and-manage-your-app"></a><h3>View and manage your app</h3>
<p>You can launch a browser to view your app by typing:

</p>
<pre><code>backlift open</code></pre>
<p>You can alternatively view the website&#39;s admin page by typing:

</p>
<pre><code>backlift admin</code></pre>
<p>That&#39;s all there is to getting started. The demo template contains a tutorial that will show you how to build a backbone.js app with Backlift. You can run it by typing:

</p>
<pre><code>backlift create:backbone-demo demoapp</code></pre>

</div>
        <footer id="footer">
            Powered by <a href="http://github.com/maximebf/beautiful-docs">beautiful-docs</a> -
            <a href="#top">Back to top</a> - <a href="/docs/all.html">Everything on a single page</a>
            - <a href="?print=1">Print current page</a> - <a href="/docs/all.html?print=1">Print all pages</a>
            
        </footer>
    </div>
</body>
</html>
